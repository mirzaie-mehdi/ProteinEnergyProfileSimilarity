# ProteinEnergyProfileSimilarity
This repository contains all the necessary code and resource data to calculate the energy profile from protein structures or sequences. It includes the following functions and data:

1. A non-redundant dataset of protein chains was employed to derive the distance-dependent knowledge-based potential. These protein structures served as the basis for training and calculating the potential function. The PDB IDs used are listed in the `Train_Energy/list_with_ChainID.txt` file, and the `Train_Energy/Train_Energy.m` script is used to compute the knowledge-based potential. The resulting distance-dependent potential between pairs of atoms is saved in the `Train_Energy/energy_dell_dunbrack.mat` and `Data/csv/energy.csv` files.

2. The script `Energy_Predictor_Matrix/estimateP.m` was employed to create the energy prediction matrix. The resulting file `Energy_Predictor_Matrix/zzi.mat` generated by `Energy_Predictor_Matrix/Zi.m` was utilized as input for `Energy_Predictor_Matrix/estimateP.m`.

3. All functions needed to convert PDB files into energy profiles are found in `Functions.R`. The `Profile_Energy.Rmd` file contains the code chunks used to calculate energy profiles for each dataset discussed in the manuscript. Each chunk is briefly described before its corresponding section, and the output from each chunk is already saved as an RDS file in the `Data/rds` folder.

    #### Note:
   To obtain the results of TM-Vec, you need to install the TM-Vec software as instructed at https://github.com/tymor22/tm-vec. The `Functions` folder contains four Python scripts that generate the TM-Vec results. For instance, you can reproduce the results for bacteriocins by running the script `tm_vec_bac.py`. The results of `tm_vec_bac.py`, `tm_vec_CT_Ho_cathID_filtered.py`, `tm_vec_Ferritin_Like_seq.py` scripts are already saved  as `disTM_vec_bac.csv`, `disTM_vec_CT_Ho_cathID_filtered.csv`, `disTM_vec_Ferritin_Like_seq.csv` in the `Data/csv/` folder. The result of `tm_vec_fiveSF.py` is shared via the google drive link:
   https://drive.google.com/drive/folders/1osbntpxhGUFtQsG-beiJDQvAfWeCBMzl?usp=drive_link
   

   To obtain the TM-Vec and TM-score results on the Covid dataset, you need to run the scripts `tm_vec_spike.py` and `tm_score_spike.py` located in the `Data/covidPDB/` folder. The results of these scripts are already saved in this folder as `disTM_vec_spike.csv` and `disTM_score_spike.csv`. The RMSD results for this dataset can be obtained from the script `Functions/RMSD_spike.R`. To run this script, you need to have the `muscle3.8.1551` software installed. The results of `Functions/RMSD_spike.R` script has been already saved at `Data/covidPDB/RMSD_spike.rds`.

5. The file `Results_Figures_Tables.Rmd` contains all chunks used to generate results, figures and tables for every dataset referenced in the manuscript. All necessary files for running the `Results_Figures_Tables.Rmd` file have already been created and saved using the `Profile_Energy.Rmd` file.

 ## Datasets Used in This Project
Below is the list of datasets utilized in this project:

- Training Set for Knowledge-Based Potential: [PDBIDs](Train_Energy/list_with_chainID_rm_Olaps.txt)
- Protein Domains in [ASTRAL40](Data/csv/astral-scopedom-seqres-gd-sel-gs-bib-40-2.08.fa) and [ASTRAL95](Data/csv/astral-scopedom-seqres-gd-sel-gs-bib-95-2.08.fa).
- The list of [Bacteriocin Proteins](Data/csv/Bacteriocin.csv)
- PDBIDs of [Ferritin Superfamily](Data/csv/Ferritin_Like_seq.csv)
- The list of [C_terminal and Homing endonucleases](Data/csv/CT_Ho_cathID.csv)
- The list of [five superfamily](Data/csv/fiveSF.csv) winged helix, PH domain-like, NTF-like, Ubiquitin-like, and Immunoglobulins
- Covid19 spike proteins data set [covidPDBIDs](Data/covidPDB/)
- The list of Drug-target in [target](Data/csv/41467_2019_9186_MOESM4_ESM.xlsx)
- The list of protein in Globin [Globin](Data/Globin/Globin.csv)
- The list of proteins utilized for the large_scale proteome analysis (The protein modesl can be find in the [Large_Scale_SARS2](Data/Large_Scale_SARS2) folder according to the sars_proteom column [SARS_Proteom](Data/Large_Scale_SARS2/sars_proteom.csv).

 ## Example:
The `Example.R` file is a simple script developed to compute SPE and CPE for four alpha-globin proteins across four different species. Additionally, it demonstrates the correlation between the Total Energy calculated using SPE and CPE, as outlined below.
<img src="https://github.com/user-attachments/assets/6229e59f-8869-43f3-b864-94e6ddb8f740" width="400" height="300">
